import {
  FlowGraphExecutionBlockWithOutSignal
} from "./chunk-YQMXD425.js";
import {
  RichTypeAny
} from "./chunk-ET3Y5ZV4.js";
import {
  RegisterClass
} from "./chunk-S7NDMBDF.js";
import {
  Logger
} from "./chunk-J4DZ2XK7.js";

// node_modules/@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphConsoleLogBlock.js
var FlowGraphConsoleLogBlock = class extends FlowGraphExecutionBlockWithOutSignal {
  constructor(config) {
    super(config);
    this.message = this.registerDataInput("message", RichTypeAny);
    this.logType = this.registerDataInput("logType", RichTypeAny, "log");
    if (config?.messageTemplate) {
      const matches = this._getTemplateMatches(config.messageTemplate);
      for (const match of matches) {
        this.registerDataInput(match, RichTypeAny);
      }
    }
  }
  /**
   * @internal
   */
  _execute(context) {
    const typeValue = this.logType.getValue(context);
    const messageValue = this._getMessageValue(context);
    if (typeValue === "warn") {
      Logger.Warn(messageValue);
    } else if (typeValue === "error") {
      Logger.Error(messageValue);
    } else {
      Logger.Log(messageValue);
    }
    this.out._activateSignal(context);
  }
  /**
   * @returns class name of the block.
   */
  getClassName() {
    return "FlowGraphConsoleLogBlock";
  }
  _getMessageValue(context) {
    if (this.config?.messageTemplate) {
      let template = this.config.messageTemplate;
      const matches = this._getTemplateMatches(template);
      for (const match of matches) {
        const value = this.getDataInput(match)?.getValue(context);
        if (value !== void 0) {
          template = template.replace(new RegExp(`\\{${match}\\}`, "g"), value.toString());
        }
      }
      return template;
    } else {
      return this.message.getValue(context);
    }
  }
  _getTemplateMatches(template) {
    const regex = /\{([^}]+)\}/g;
    const matches = [];
    let match;
    while ((match = regex.exec(template)) !== null) {
      matches.push(match[1]);
    }
    return matches;
  }
};
RegisterClass("FlowGraphConsoleLogBlock", FlowGraphConsoleLogBlock);

export {
  FlowGraphConsoleLogBlock
};
//# sourceMappingURL=chunk-LFI7HSCY.js.map
